/*! For license information please see PluginManager.js.LICENSE.txt */
!function(){var t={54:function(t,e,n){"use strict";function r(t,e){for(var n=[],r={},a=0;a<e.length;a++){var i=e[a],o=i[0],s={id:t+":"+a,css:i[1],media:i[2],sourceMap:i[3]};r[o]?r[o].parts.push(s):n.push(r[o]={id:o,parts:[s]})}return n}n.d(e,{A:function(){return h}});var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,u=!1,c=function(){},p=null,d="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,n,a){u=n,p=a||{};var o=r(t,e);return y(o),function(e){for(var n=[],a=0;a<o.length;a++){var s=o[a];(l=i[s.id]).refs--,n.push(l)}for(e?y(o=r(t,e)):o=[],a=0;a<n.length;a++){var l;if(0===(l=n[a]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete i[l.id]}}}}function y(t){for(var e=0;e<t.length;e++){var n=t[e],r=i[n.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](n.parts[a]);for(;a<n.parts.length;a++)r.parts.push(g(n.parts[a]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var o=[];for(a=0;a<n.parts.length;a++)o.push(g(n.parts[a]));i[n.id]={id:n.id,refs:1,parts:o}}}}function v(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function g(t){var e,n,r=document.querySelector("style["+d+'~="'+t.id+'"]');if(r){if(u)return c;r.parentNode.removeChild(r)}if(f){var a=l++;r=s||(s=v()),e=w.bind(null,r,a,!1),n=w.bind(null,r,a,!0)}else r=v(),e=C.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}var m,b=(m=[],function(t,e){return m[t]=e,m.filter(Boolean).join("\n")});function w(t,e,n,r){var a=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,a);else{var i=document.createTextNode(a),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function C(t,e){var n=e.css,r=e.media,a=e.sourceMap;if(r&&t.setAttribute("media",r),p.ssrId&&t.setAttribute(d,e.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},656:function(){},887:function(t,e,n){var r=n(656);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[t.id,r,""]]),r.locals&&(t.exports=r.locals),(0,n(54).A)("7690077b",r,!0,{})}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return r};var n,r={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function p(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(n){p=function(t,e,n){return t[e]=n}}function d(t,e,n,r){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),s=new _(r||[]);return o(i,"_invoke",{value:P(t,n,s)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=d;var h="suspendedStart",y="suspendedYield",v="executing",g="completed",m={};function b(){}function w(){}function C(){}var x={};p(x,l,(function(){return this}));var k=Object.getPrototypeOf,$=k&&k(k(O([])));$&&$!==a&&i.call($,l)&&(x=$);var L=C.prototype=b.prototype=Object.create(x);function T(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function r(a,o,s,l){var u=f(e[a],e,o);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==t(p)&&i.call(p,"__await")?n.resolve(p.__await).then((function(t){r("next",t,s,l)}),(function(t){r("throw",t,s,l)})):n.resolve(p).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,a){r(t,e,n,a)}))}return a=a?a.then(i,i):i()}})}function P(t,e,r){var a=h;return function(i,o){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===i)throw o;return{value:n,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var l=I(s,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var u=f(t,e,r);if("normal"===u.type){if(a=r.done?g:y,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=g,r.method="throw",r.arg=u.arg)}}}function I(t,e){var r=e.method,a=t.iterator[r];if(a===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,I(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=f(a,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function U(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(U,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,o(L,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:w,configurable:!0}),w.displayName=p(C,c,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,p(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},r.awrap=function(t){return{__await:t}},T(E.prototype),p(E.prototype,u,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,a,i){void 0===i&&(i=Promise);var o=new E(d(t,e,n,a),i);return r.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(L),p(L,c,"Generator"),p(L,l,(function(){return this})),p(L,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=O,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,a){return s.type="throw",s.arg=t,e.next=r,a&&(e.method="next",e.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}},r}function r(t,e,n,r,a,i,o){try{var s=t[i](o),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,l,"next",t)}function l(t){r(o,a,i,s,l,"throw",t)}s(void 0)}))}}n(887),function(t){Craft.PluginManager=Garnish.Base.extend({$table:null,init:function(){var e=this;this.$table=t("#plugins"),this.$table.length&&this.$table.find("tbody tr").each((function(e,n){var r=t(n),a=r.find(".action-btn").disclosureMenu().data("disclosureMenu");a&&(a.$container.find('[data-action="copy-plugin-handle"]').on("activate",(function(){Craft.ui.createCopyTextPrompt({label:Craft.t("app","Plugin Handle"),value:r.data("handle")})})),a.$container.find('[data-action="copy-package-name"]').on("activate",(function(){Craft.ui.createCopyTextPrompt({label:Craft.t("app","Package Name"),value:r.data("package-name")})})))})),this.getPluginLicenseInfo().then((function(r){for(var a in r)r.hasOwnProperty(a)&&(r[a].isComposerInstalled?new n(e,t("#plugin-"+a)).update(r[a]):e.addUninstalledPluginRow(a,r[a]))}))},getPluginLicenseInfo:function(){return new Promise((function(t,e){Craft.sendApiRequest("GET","cms-licenses",{params:{include:"plugins"}}).then((function(n){var r={pluginLicenses:n.license.pluginLicenses||[]};Craft.sendActionRequest("POST","app/get-plugin-license-info",{data:r}).then((function(e){t(e.data)})).catch((function(){e()}))})).catch(e)}))},addUninstalledPluginRow:function(n,r){this.$table.length||(this.$table=t("<table/>",{id:"plugins",class:"data fullwidth collapsible",html:"<tbody></tbody>"}),t("#no-plugins").replaceWith(this.$table));var i,o,s,l=t("<tr/>",{data:{handle:n}}).appendTo(this.$table.children("tbody")).append(t("<th/>").append(t("<div/>",{class:"plugin-infos"}).append(t("<div/>",{class:"icon"}).append(t("<img/>",{src:r.iconUrl}))).append(t("<div/>",{class:"plugin-details"}).append(t("<h2/>",{text:r.name})).append(r.description?t("<p/>",{text:r.description}):t()).append(r.documentationUrl?t("<p/>",{class:"links"}).append(t("<a/>",{href:r.documentationUrl,target:"_blank",text:Craft.t("app","Documentation")})):t()).append(t("<div/>",{class:"flex license-key"}).append(t("<div />",{class:"pane"}).append(t("<input/>",{class:"text code",size:29,maxlength:29,value:Craft.PluginManager.normalizeUserKey(r.licenseKey),readonly:!0,disabled:!0}))))))).append(t("<td/>",{class:"nowrap","data-title":Craft.t("app","Status")}).append(t("<span/>",{class:"status disabled"})).append(t("<span/>",{class:"light",text:Craft.t("app","Missing")}))).append(t("<td/>",{class:"nowrap thin actions-cell"}));if(Craft.initUiElements(l),r.latestVersion){var u=l.find(".actions-cell");u.attr("data-title",Craft.t("app","Actions"));var c="menu-".concat(Math.floor(1e6*Math.random())),p=t("<button/>",{type:"button",class:"btn menubtn action-btn hairline","aria-label":Craft.t("app","Actions"),"aria-controls":c,title:Craft.t("app","Actions"),"data-disclosure-trigger":""}).appendTo(u);t("<div/>",{id:c,class:"menu menu--disclosure"}).appendTo(u);var d=p.disclosureMenu().data("disclosureMenu");d.addItems([{icon:(s=a(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("clipboard");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}),label:Craft.t("app","Copy plugin handle"),onActivate:function(){Craft.ui.createCopyTextPrompt({label:Craft.t("app","Plugin Handle"),value:n})}},{icon:(o=a(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("clipboard");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)}),label:Craft.t("app","Copy package name"),onActivate:function(){Craft.ui.createCopyTextPrompt({label:Craft.t("app","Package Name"),value:r.packageName})}}]),d.addHr(),d.addGroup(),d.addItem({icon:(i=a(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("plus");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)}),label:Craft.t("app","Install"),action:"pluginstore/install",params:{packageName:r.packageName,handle:n,edition:r.licensedEdition,version:r.latestVersion,licenseKey:r.licenseKey,return:"settings/plugins"}})}}},{normalizeUserKey:function(t){return"string"!=typeof t||""===t?"":"$"===t[0]?t:t.replace(/.{4}/g,"$&-").substring(0,29).toUpperCase()}});var n=Garnish.Base.extend({manager:null,$row:null,$details:null,$keyContainer:null,$keyInput:null,$spinner:null,$buyBtn:null,handle:null,updateTimeout:null,init:function(t,e){this.manager=t,this.$row=e,this.$details=this.$row.find(".plugin-details"),this.$keyContainer=e.find(".license-key"),this.$keyInput=this.$keyContainer.find("input.text").removeAttr("readonly"),this.$buyBtn=this.$keyContainer.find(".btn"),this.$spinner=e.find(".spinner"),this.handle=this.$row.data("handle"),this.addListener(this.$keyInput,"focus","onKeyFocus"),this.addListener(this.$keyInput,"input","onKeyChange")},getKey:function(){return this.$keyInput.val().replace(/\-/g,"").toUpperCase()},onKeyFocus:function(){this.$keyInput.select()},onKeyChange:function(){this.updateTimeout&&clearTimeout(this.updateTimeout);var t=this.getKey();if(0===t.length||24===t.length||t.length>1&&"$"===t[0]){var e=Craft.PluginManager.normalizeUserKey(t);this.$keyInput.val(e),this.updateTimeout=setTimeout(this.updateLicenseStatus.bind(this),100)}},updateLicenseStatus:function(){var t=this;this.$spinner.removeClass("hidden");var e={handle:this.handle,key:this.getKey()};Craft.sendActionRequest("POST","app/update-plugin-license",{data:e}).then((function(){t.manager.getPluginLicenseInfo().then((function(e){t.$spinner.addClass("hidden"),t.update(e[t.handle])}))}))},update:function(e){var n=this.$row.find(".license-key-status");if("valid"==e.licenseKeyStatus||e.licenseIssues.length){var r=t("<span/>",{class:"license-key-status "+(0===e.licenseIssues.length?"valid":"")});n.length?n.replaceWith(r):r.appendTo(this.$row.find(".icon"))}else n.length&&n.remove();var a=this.$row.find(".edition");if(e.hasMultipleEditions||e.isTrial){var i=e.upgradeAvailable?t("<a/>",{href:Craft.getUrl("plugin-store/"+this.handle),class:"edition"}):t("<div/>",{class:"edition"});e.hasMultipleEditions&&t("<div/>",{class:"edition-name",text:e.edition}).appendTo(i),e.isTrial&&t("<div/>",{class:"edition-trial",text:Craft.t("app","Trial")}).appendTo(i),a.length?a.replaceWith(i):i.insertBefore(this.$row.find(".version"))}else a.length&&a.remove();var o=e.licenseKey||"unknown"!==e.licenseKeyStatus;if(o?(this.$keyContainer.removeClass("hidden"),e.licenseKey&&!this.$keyInput.val().match(/^\$/)&&this.$keyInput.val(Craft.PluginManager.normalizeUserKey(e.licenseKey))):this.$keyContainer.addClass("hidden"),o&&e.licenseIssues.length?this.$keyInput.addClass("error"):this.$keyInput.removeClass("error"),this.$row.find("p.error").remove(),e.licenseIssues.length){for(var s=t(),l=0;l<e.licenseIssues.length;l++){var u=void 0;switch(e.licenseIssues[l]){case"no_trials":u=Craft.t("app","Plugin trials are not allowed on this domain.");break;case"wrong_edition":u=Craft.t("app","This license is for the {name} edition.",{name:e.licensedEdition.charAt(0).toUpperCase()+e.licensedEdition.substring(1)})+' <button type="button" class="btn submit small formsubmit">'+Craft.t("app","Switch")+"</button>";break;case"mismatched":u=Craft.t("app",'This license is tied to another Craft install. Visit {accountLink} to detach it, or <a href="{buyUrl}">buy a new license</a>',{accountLink:'<a href="https://console.craftcms.com" rel="noopener" target="_blank">console.craftcms.com</a>',buyUrl:Craft.getCpUrl("plugin-store/buy/".concat(this.handle,"/").concat(e.edition))});break;case"astray":u=Craft.t("app","This license isnâ€™t allowed to run version {version}.",{version:e.version});break;case"required":u=Craft.t("app","A license key is required.");break;default:u=Craft.t("app","Your license key is invalid.")}var c=t("<p/>",{class:"error",html:u});if("wrong_edition"===e.licenseIssues[l]){var p=t("<form/>",{method:"post","accept-charset":"UTF-8"}).append(Craft.getCsrfInput()).append(t("<input/>",{type:"hidden",name:"action",value:"plugins/switch-edition"})).append(t("<input/>",{type:"hidden",name:"pluginHandle",value:this.handle})).append(t("<input/>",{type:"hidden",name:"edition",value:e.licensedEdition})).append(c);Craft.initUiElements(p),s=s.add(p)}else s=s.add(c)}s.appendTo(this.$details),Craft.initUiElements()}var d=this.$row.find(".expired");if(e.expired){var f=t("<p/>",{class:"warning with-icon expired",html:Craft.t("app","This license has expired.")+" "+Craft.t("app","<a>Renew now</a> for another year of updates.").replace("<a>",'<a href="'+e.renewalUrl+'" target="_blank">')});d.length?d.replaceWith(f):f.appendTo(this.$details)}"trial"===e.licenseKeyStatus?(this.$buyBtn.removeClass("hidden"),e.licenseIssues.length?this.$buyBtn.addClass("submit"):this.$buyBtn.removeClass("submit")):this.$buyBtn.addClass("hidden")}})}(jQuery)}()}();
//# sourceMappingURL=PluginManager.js.map