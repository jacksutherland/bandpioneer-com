class BandPioneerUX{static stickyListeners=[];constructor(){this.addHeaderEvents(),this.addTopicMenuEvents(),this.startAnimations()}static getBreakpoint(){return window.matchMedia("(max-width: 576px)").matches?"sm":window.matchMedia("(max-width: 768px)").matches?"md":window.matchMedia("(max-width: 992px)").matches?"lg":window.matchMedia("(max-width: 1200px)").matches?"xl":"xxl"}static addStickyListener(e){BandPioneerUX.stickyListeners.push(e)}static callStickyListeners(e){BandPioneerUX.stickyListeners.forEach((t=>t(e)))}login(e){return void 0===e&&(e="Sign in to Band Pioneer"),this.openModal("#login-modal",null,e)||(window.location.href="/account"),!1}signUp(){this.alert('<iframe src="https://cdn.forms-content.sg-form.com/dfbe0477-dfb9-11ed-a98c-c641367c2345"/>')}alert(e,t){const n=document.createElement("div");n.classList.add("overlay");const i=this.isHTML(e),o=e.length>100||i?"600px":"400px",s=document.createElement("div");s.classList.add("modal"),s.style.cssText="max-width:"+o+";";const r=document.createElement("a");r.classList.add("close-button"),r.innerHTML="x",r.href="/",r.onclick=function(e){e.preventDefault(),document.body.removeChild(n),"function"==typeof t&&t()};const a=document.createElement(i?"div":"p");a.innerHTML=e,n.onclick=function(e){e.target===n&&(document.body.removeChild(n),"function"==typeof t&&t())},s.appendChild(r),s.appendChild(a),n.appendChild(s),document.body.appendChild(n)}openModal(e,t,n){const i=document.querySelector(e);if(!i)return!1;const o=i.querySelector(".modal"),s=o.querySelector(".close-button")||o.querySelector(".close-icon-button");if("string"==typeof n){let e=o.querySelector("h3");e&&(e.innerText=n)}return s.onclick=function(e){e.preventDefault(),"function"==typeof t&&t(),i.classList.remove("show")},i.onclick=function(e){e.target.classList.contains("login-provider")||e.preventDefault(),e.target===i&&("function"==typeof t&&t(),i.classList.remove("show"))},i.classList.add("show"),!0}isHTML(e){return"<"===e.charAt(0)}addHeaderEvents(){function e(t){document.getElementById("search-toggle").checked=!1,document.querySelector(".search-dropdown").removeEventListener("mouseleave",e)}document.getElementById("search-toggle").addEventListener("change",(function(){this.checked&&(document.getElementById("search-input").focus(),document.querySelector(".search-dropdown").addEventListener("mouseleave",e))}));const t=function(e){e.target.classList.contains("dropdown")||(document.querySelectorAll("header nav")[0].classList.remove("show"),document.querySelectorAll("header nav ul.show").forEach((e=>{e.classList.remove("show")})),document.removeEventListener("click",t))};document.getElementById("open-menu").addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();document.querySelectorAll("header nav")[0].classList.toggle("show")?document.addEventListener("click",t):document.removeEventListener("click",t)}));const n=document.querySelectorAll("header nav ul a.dropdown"),i=function(e){document.querySelectorAll("header nav ul.show").forEach((t=>{t.contains(e.target)||e.target.classList.contains("dropdown")||(t.classList.remove("show"),document.removeEventListener("click",i))}))};n.forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=this.nextElementSibling;t.classList.toggle("show")?document.addEventListener("click",i):document.removeEventListener("click",i),document.querySelectorAll("header nav ul.show").forEach((e=>{e!==t&&e.classList.remove("show")}))}))}));const o=document.querySelector(".sticky-tracker");if(o){const e=document.querySelector("body");new window.IntersectionObserver((t=>{t[0].boundingClientRect.top<250&&(t[0].isIntersecting?(e.classList.remove("sticky"),BandPioneerUX.callStickyListeners(!1)):(e.classList.add("sticky"),BandPioneerUX.callStickyListeners(!0)))}),{rootMargin:"-150px 0px 0px 0px"}).observe(o)}}addTopicMenuEvents(){document.querySelectorAll("[data-popup]").forEach((e=>{var t={obj:this,pop:e};e.hovering=!1,this.popoutDuration=Date.now(),e.addEventListener("mouseover",function(e){const t=Date.now()-this.obj.popoutDuration<500?0:1e3;this.pop.hovering=!0,this.obj.popTimer=setTimeout(function(){this.pop.hovering&&document.getElementById(this.pop.dataset.popup).classList.add("show")}.bind(this),t)}.bind(t)),e.addEventListener("mouseout",function(e){clearTimeout(this.obj.popTimer),document.getElementById(this.pop.dataset.popup).classList.remove("show"),this.pop.hovering=!1,this.obj.popoutDuration=Date.now()}.bind(t))}))}startAnimations(){var e=document.getElementById("cta-text"),t=document.getElementById("cta-image"),n=null;if(e&&t){const s=1,r=parseInt(t.dataset.max);var i=parseInt(t.dataset.idx),o=1;const a=function(){i=i===r?1:i+1,t.classList.add("blur-out"),setTimeout((function(){t.src="/assets/images/bp-homepage-artist-"+i+".png",t.classList.remove("blur-out"),c()}),500)},c=function(){o<r&&(o++,(new Image).src="/assets/images/bp-homepage-artist-"+(i==r?s:i+1)+".png")};new window.IntersectionObserver((e=>{e[0].isIntersecting?n=setInterval(a,8e3):clearInterval(n)})).observe(e),c()}}createBlogPost(){new this.BlogPost}createBandCarousels(){document.querySelectorAll(".band-carousel").forEach((e=>{new this.BandCarousel(e)}))}openRankComparisonModal(e){bp.openModal(".rank-comparison-modal"),document.querySelectorAll(".ranker-modal ul li").forEach((function(t){t.classList.remove("pulsate"),t.dataset.key==e&&setTimeout(function(){this.classList.add("pulsate")}.bind(t),200)}))}BandCarousel=class{constructor(e){this.scrollSpeed=.3,this.direction="left",this.slider=e.querySelector(".band-slider"),this.slides=this.slider.querySelectorAll(".slide"),this.carouselAnimationRequest=null,this.carouselAnimationFrame=null,this.slides.forEach((e=>{let t=8*Math.random()-4;e.style.transform="rotate("+t+"deg)"})),this.addEventListeners(),this.createAnimationFrame()}addEventListeners(){this.resize=function(){this.slides=this.slider.querySelectorAll(".slide");let e=0;this.slides.forEach((t=>{e+=t.getBoundingClientRect().width})),this.slider.style.width=e+50+"px"}.bind(this),window.addEventListener("resize",function(){this.resize()}.bind(this));let e=function(e){let t=void 0===e.clientX?e.touches[0].clientX-this.slider.getBoundingClientRect().x:e.clientX-this.slider.getBoundingClientRect().x;this.stopAnimation();let n=function(e){let n=void 0===e.pageX?e.touches[0].pageX:e.pageX;if(n<0||n>window.innerWidth)return!1;this.slider.offsetWidth,this.slider.getBoundingClientRect();this.slider.style.transform="translateX("+(n-t)+"px)"}.bind(this),i=function(){document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",i),document.removeEventListener("touchend",i),this.slider.onmouseup=null,this.startAnimation()}.bind(this);document.addEventListener("mousemove",n),document.addEventListener("touchmove",n),document.addEventListener("mouseup",i),document.addEventListener("touchend",i)}.bind(this);this.slider.addEventListener("mousedown",e),this.slider.addEventListener("touchstart",e),this.slider.ondragstart=function(){return!1},this.resize()}startAnimation=function(){this.carouselAnimationRequest=requestAnimationFrame(this.carouselAnimationFrame)};stopAnimation=function(){cancelAnimationFrame(this.carouselAnimationRequest),this.carouselAnimationRequest=null};createAnimationFrame(){this.carouselAnimationFrame=function(){this.carouselAnimationRequest%1e3==0&&this.resize();let e=this.slider.getBoundingClientRect();e.width<window.innerWidth?e.x<=0?this.direction="right":e.width+e.x>window.innerWidth&&(this.direction="left"):e.x>=0?this.direction="left":e.width- -1*e.x<window.innerWidth&&(this.direction="right"),this.slider.style.transform="translateX("+("left"===this.direction?e.x-this.scrollSpeed:e.x+this.scrollSpeed)+"px)",null!==this.carouselAnimationRequest&&this.startAnimation()}.bind(this),this.startAnimation()}};BlogPost=class{constructor(){this.readingProgress(),this.toc(),this.instagram(),this.youtubeLoader()}toc(){const e=document.querySelector(".table-of-contents");if(null===e)return!1;const t=document.querySelector(".blog-header"),n=document.querySelector(".blog-comments"),i=document.querySelector(".related-content"),o=document.querySelector(".blog-container");let s=!1,r=!1;const a=new IntersectionObserver((a=>{a.forEach((a=>{a.target===t?a.isIntersecting?o.classList.remove("sticky"):o.classList.add("sticky"):a.target!==n&&a.target!==i||(a.isIntersecting?(e.classList.add("fadeaway"),a.target===n?s=!0:a.target===i&&(r=!0)):(a.target===n?s=!1:a.target===i&&(r=!1),!e||s||r||e.classList.remove("fadeaway")))}))}),{threshold:0,rootMargin:"-70px 0px 0px 0px"});t&&o&&a.observe(t),a.observe(n),a.observe(i),e&&e.querySelector(".section-title").addEventListener("click",(function(t){e.querySelector("ul").classList.toggle("close")}))}youtubeLoader(){const e=document.querySelectorAll(".yt-loader"),t=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){t.unobserve(e.target);let n=e.target.dataset.caption.length>0?e.target.dataset.caption:e.target.dataset.title,i=`https://www.youtube.com/embed/${e.target.dataset.id}`;e.target.dataset.minute.length&&(i+=`?start=${e.target.dataset.minute}`);let o=`<figure class="video">\n\t\t\t\t\t\t\t\t\t\t<div class="player">\n\t\t\t\t\t\t\t\t\t\t\t<iframe width="560" height="315" src="${i}" title="${n}" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>\n\t\t\t\t\t\t\t\t\t\t</div>`;e.target.dataset.caption.length>0&&(o+=`<figcaption>${e.target.dataset.caption}</figcaption>`),o+="</figure>",e.target.outerHTML=o}}))}),{threshold:0,rootMargin:"150px"});e.forEach((e=>{t.observe(e)}))}readingProgress(){const e=document.getElementById("reading-time");if(e){const t=e.querySelector(".reading-progress"),n=Array.from(document.querySelectorAll(".section-title")).pop(),i=n.offsetTop+n.offsetHeight+100;function o(){const e=document.documentElement,t=document.body,n="scrollTop",o=Math.floor((e[n]||t[n])/(i-e.clientHeight)*100);return o>100?100:o}function s(){let e=o()+"%";t.style.width=e,t.parentElement.title="Reading Progress: "+e}BandPioneerUX.addStickyListener((function(t){t?e.classList.add("show"):e.classList.remove("show")})),window.addEventListener("scroll",(()=>{s()})),s()}}instagram(){var e=document.querySelectorAll(".instagram-media"),t=0;if(e.length>0){const n=function(i){e.forEach((i=>{if(void 0===i.embedded||!i.embedded){const o=window.scrollY+window.innerHeight;if(i.getBoundingClientRect().top+window.scrollY<o){i.embedded=!0,t++;const o=i.firstChild,s=document.createElement("iframe");s.src=`https://www.instagram.com/p/${i.dataset.id}/embed/?cr=1&v=14&wp=540&rd=https%3A%2F%2Fbandpioneer.com`,s.setAttribute("style","background: white; max-width: 540px; width: calc(100% - 2px); border-radius: 3px; border: 1px solid rgb(219, 219, 219); box-shadow: none; display: block; margin: 0px 0px 12px; min-width: 326px; padding: 0px;"),s.setAttribute("allowtransparency","true"),s.setAttribute("allowfullscreen","true"),s.setAttribute("frameborder","0"),s.setAttribute("height","705"),s.setAttribute("scrolling","no"),i.insertBefore(s,o),t>=e.length&&window.removeEventListener("scroll",n)}}}))};window.addEventListener("scroll",n)}}}}
